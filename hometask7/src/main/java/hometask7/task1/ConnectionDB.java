package hometask7.task1;import java.sql.*;import java.util.ArrayList;public class ConnectionDB {    public static void main(String[] args) throws SQLException {        try {            createDBTable();            insertRecord(1, "ladimirovich");            insertRecord(2, "Ritka_super");            insertRecord(3, "lomdz");            Service.printer(getData());            updateDB(1,"kvladimirovich");            Service.printer(getRecord(1));            insertRecord(4,"volkov");            deleteTable();        } catch (SQLException e) {            System.out.println(e.getMessage());        }    }    private static Connection getDBConnection() {        String DB_DRIVER = null;        String DB_CONNECTION = null;        String DB_USER = null;        String DB_PASSWORD = null;        try {            Service service = Service.getInstance("hometask7/src/main/resources/connInfo.properties");            DB_DRIVER = service.getProperty("DB_DRIVER");            DB_CONNECTION = service.getProperty("DB_CONNECTION");            DB_USER = service.getProperty("DB_USER");            DB_PASSWORD = service.getProperty("DB_PASSWORD");        } catch (PropertyKeyNotFoundException | PropertiesFileNotFoundException e) {            System.out.println(e.getMessage());        }        Connection dbConnection = null;        try {            Class.forName(DB_DRIVER);        } catch (ClassNotFoundException e) {            System.out.println(e.getMessage());        }        try {            dbConnection = DriverManager.getConnection(DB_CONNECTION, DB_USER, DB_PASSWORD);            return dbConnection;        } catch (SQLException e) {            System.out.println(e.getMessage());        }        return dbConnection;    }    private static void createDBTable() throws SQLException {        Connection dbConnection = null;        Statement statement = null;        String createTableSQL = "CREATE TABLE DBUSER("                + "USER_ID INTEGER(5) NOT NULL, "                + "USERNAME VARCHAR(20) NOT NULL, "                + "PRIMARY KEY (USER_ID) "                + ")";        try {            dbConnection = getDBConnection();            statement = dbConnection.createStatement();            statement.execute(createTableSQL);            System.out.println("Table \"dbuser\" is created!");        } catch (SQLException e) {            System.out.println(e.getMessage());        } finally {            if (statement != null) {                statement.close();            }            if (dbConnection != null) {                dbConnection.close();            }        }    }    private static ArrayList<Result> getData() {        Connection dbConnection = null;        Statement statement = null;        ArrayList<Result> resultArrayList = new ArrayList<>();        try {            dbConnection = getDBConnection();            statement = dbConnection.createStatement();            String selectTableSQL = "SELECT USER_ID, USERNAME FROM DBUSER";            ResultSet rs = statement.executeQuery(selectTableSQL);            while (rs.next()) {                resultArrayList.add(new Result(Integer.parseInt(rs.getString("USER_ID")),                        rs.getString("USERNAME")));            }        } catch (SQLException e) {            System.out.println(e.getMessage());        }        return resultArrayList;    }    private static void updateDB(int ID, String userName) {        Connection dbConnection = null;        Statement statement = null;        String updateTableSQL = "UPDATE DBUSER SET USERNAME = '"+userName+"' WHERE USER_ID = "+ID;        try {            dbConnection = getDBConnection();            statement = dbConnection.createStatement();            statement.execute(updateTableSQL);            System.out.println("Record is updated to DBUSER table!");        } catch (SQLException e) {            System.out.println(e.getMessage());        }    }    private static Result getRecord(int ID) {        Connection dbConnection = null;        Statement statement = null;        Result result = null;        String selectTableSQL = "SELECT USER_ID, USERNAME FROM DBUSER WHERE USER_ID = "+ID;        try {            dbConnection = getDBConnection();            statement = dbConnection.createStatement();            ResultSet rs = statement.executeQuery(selectTableSQL);            while (rs.next()) {                result = new Result(Integer.parseInt(rs.getString("USER_ID")),                        rs.getString("USERNAME"));            }        } catch (SQLException e) {            System.out.println(e.getMessage());        }        return result;    }    private static void insertRecord(int ID, String userName) {        Connection dbConnection = null;        Statement statement = null;        String insertTableSQL = "INSERT INTO DBUSER"                + "(USER_ID, USERNAME) " + "VALUES"                + "('" + ID + "','" + userName + "')";        try {            dbConnection = getDBConnection();            statement = dbConnection.createStatement();            statement.executeUpdate(insertTableSQL);        } catch (SQLException e) {            System.out.println(e.getMessage());        }    }    private static void deleteTable() {        Connection dbConnection = null;        Statement statement = null;        String deleteTable = "DROP TABLE DBUSER";        try {            dbConnection = getDBConnection();            statement = dbConnection.createStatement();            statement.execute(deleteTable);            System.out.println("DB is deleted!");        } catch (SQLException e) {            System.out.println(e.getMessage());        }    }}